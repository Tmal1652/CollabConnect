<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Social – CollabConnect</title>
  <meta name="description" content="Team feed for updates, collaboration, and creativity." />
  <meta name="theme-color" content="#0b1323" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#f7f9fc" media="(prefers-color-scheme: light)">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="preload" href="style.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
  <noscript><link rel="stylesheet" href="style.min.css" /></noscript>
  <link rel="stylesheet" href="style.css" media="print" onload="this.media='all'" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="manifest" href="manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="mobile-web-app-capable" content="yes" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <script src="mobile/auth.js" defer></script>
</head>
<body data-logo="text">
  <a href="#main" class="skip-link">Skip to main content</a>

  <nav class="navbar" aria-label="Primary Navigation">
    <a class="logo" href="index.html" aria-label="CollabConnect home">
      <span class="logo-mark" aria-hidden="true">
        <svg class="logo-glyph" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="7" y1="12" x2="16.5" y2="7"/>
          <line x1="7" y1="12" x2="16.5" y2="17"/>
          <line x1="16.5" y1="7" x2="16.5" y2="17"/>
          <circle cx="7" cy="12" r="2" fill="currentColor" stroke="none"/>
          <circle cx="16.5" cy="7" r="2" fill="currentColor" stroke="none"/>
          <circle cx="16.5" cy="17" r="2" fill="currentColor" stroke="none"/>
        </svg>
      </span>
      <span class="logo-text"><span class="logo-strong">Collab</span>Connect</span>
    </a>
    <ul class="nav-links">
      <li><a href="index.html#home" aria-label="Home"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 11.5 12 4l9 7.5"/><path d="M5 10v10h14V10"/></svg></span><span class="nav-label">Home</span></a></li>
      <li><a href="about.html" aria-label="About"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg></span><span class="nav-label">About</span></a></li>
      <li><a href="features.html" aria-label="Features"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg></span><span class="nav-label">Features</span></a></li>
      <li><a href="social.html" aria-label="Social" class="requires-auth active" data-auth="hide" aria-current="page"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 9h8"/><path d="M8 13h6"/><rect x="4" y="5" width="16" height="14" rx="3"/></svg></span><span class="nav-label">Social</span></a></li>
      <li><a href="projects.html" aria-label="Projects"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7h18"/><path d="M3 12h18"/><path d="M3 17h18"/></svg></span><span class="nav-label">Projects</span></a></li>
      <li><a href="profile.html" aria-label="Profile" class="requires-auth" data-auth="hide"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5Z"/><path d="M3 22c1.5-4 5-7 9-7s7.5 3 9 7"/></svg></span><span class="nav-label">Profile</span></a></li>
      <li><a href="login.html" aria-label="Login"><span class="nav-icon" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg></span><span class="nav-label">Login</span></a></li>
    </ul>
  </nav>

  <main id="main" class="page-offset social-page container">
    <header class="profile-header">
      <div class="profile-heading-icon" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 9h8"/><path d="M8 13h6"/><rect x="4" y="5" width="16" height="14" rx="3"/></svg></div>
      <div>
        <h1 class="page-title">Team Feed</h1>
        <p class="page-lead">Modern, focused space for updates and collaboration</p>
      </div>
    </header>

    <section class="social-layout">
      <aside class="s-left s-card" aria-label="Your summary">
        <div class="s-profile">
          <div id="sProfileAvatar" class="avatar">U</div>
          <div>
            <div id="sProfileName" class="s-name">User</div>
            <div id="sProfileEmail" class="s-email">user@example.com</div>
            <span id="sProfileRole" class="s-role chip">User</span>
          </div>
        </div>
        <ul class="s-meta">
          <li><span>Posts</span><strong id="sMetaPosts">—</strong></li>
          <li><span>Comments</span><strong id="sMetaComments">—</strong></li>
        </ul>
      </aside>

      <section class="s-center">
        <div class="shorts-header">
          <div class="social-switch" role="tablist" aria-label="Feed view switch">
            <button class="tab is-active" role="tab" aria-selected="true" data-view="all">Feed</button>
            <button class="tab" role="tab" aria-selected="false" data-view="projects">Projects</button>
            <button class="tab" role="tab" aria-selected="false" data-view="videos">Videos</button>
          </div>
        </div>
        <article class="composer-card" aria-labelledby="composer-title">
          <h2 id="composer-title" class="sr-only">Create post</h2>
          <form id="composerForm" class="composer" autocomplete="off">
            <div class="composer-avatar">
              <div id="composerAvatar" class="avatar" aria-hidden="true">U</div>
            </div>
            <div class="composer-field">
              <label class="sr-only" for="composerText">Post text</label>
              <textarea id="composerText" name="text" rows="3" maxlength="280" placeholder="Share what you're working on..." required></textarea>
              <div class="composer-meta"><span id="composerCount" aria-live="polite">0/280</span></div>
            </div>
            <div class="composer-actions">
              <button type="submit" class="auth-btn" disabled>Post</button>
            </div>
          </form>
        </article>
        <div class="center-scroll" aria-label="Scrollable feed area">
          <div id="feed" class="feed" aria-live="polite" aria-busy="false" data-mode="all"></div>
        </div>
        <!-- Mobile-only compose entrypoint (FAB) and modal -->
        <button id="composerFab" class="composer-fab" aria-label="Create a post" hidden>＋</button>
        <div id="composerMobileModal" class="modal" aria-hidden="true">
          <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="composerMobileTitle">
            <button class="close" aria-label="Close">×</button>
            <h3 id="composerMobileTitle">Create post</h3>
            <form id="composerFormMobile" class="composer" autocomplete="off">
              <div class="composer-avatar">
                <div id="composerAvatarMobile" class="avatar" aria-hidden="true">U</div>
              </div>
              <div class="composer-field">
                <label class="sr-only" for="composerTextMobile">Post text</label>
                <textarea id="composerTextMobile" name="text" rows="4" maxlength="280" placeholder="Share what you're working on..." required></textarea>
                <div class="composer-meta"><span id="composerCountMobile" aria-live="polite">0/280</span></div>
              </div>
              <div class="composer-actions">
                <button type="submit" class="auth-btn" disabled>Post</button>
              </div>
            </form>
          </div>
        </div>
      </section>

      <aside class="s-right s-card" aria-label="Trends and suggestions">
        <div class="s-block">
          <h2 class="s-title">Trends</h2>
          <ul class="s-list">
            <li><span class="tag">#DesignSprint</span><span class="count">124</span></li>
            <li><span class="tag">#OpenSource</span><span class="count">89</span></li>
            <li><span class="tag">#CollabTips</span><span class="count">63</span></li>
          </ul>
        </div>
        <div class="s-block">
          <h2 class="s-title">People to follow</h2>
          <ul class="s-people">
            <li><div class="avatar" style="--h:290">A</div><div><div class="p-name">alex.dev</div><div class="p-role">Developer</div></div><button class="btn subtle">Follow</button></li>
            <li><div class="avatar" style="--h:120">M</div><div><div class="p-name">mia.design</div><div class="p-role">Designer</div></div><button class="btn subtle">Follow</button></li>
            <li><div class="avatar" style="--h:30">S</div><div><div class="p-name">sam.ops</div><div class="p-role">Ops</div></div><button class="btn subtle">Follow</button></li>
          </ul>
        </div>
      </aside>
    </section>
  </main>

  <footer class="footer site-footer" aria-label="Website Footer">
    <p>© 2025 CollabConnect. All Rights Reserved. Created by Tyler Malovrh</p>
    <ul class="social-links">
      <li><a class="chip" href="#" aria-label="Follow us on X" rel="noopener">X</a></li>
      <li><a class="chip" href="#" aria-label="Follow us on LinkedIn" rel="noopener">LinkedIn</a></li>
      <li><a class="chip" href="#" aria-label="Follow us on Facebook" rel="noopener">Facebook</a></li>
    </ul>
  </footer>

  <script src="app.js"></script>
  <script src="social.js" defer></script>
  <!-- Mobile splash overlay: blocks Social on phones for normal users; dev accounts bypass automatically -->
  <div id="mobileBlocker" class="mobile-splash" role="dialog" aria-modal="true" aria-labelledby="mobileSplashTitle" aria-describedby="mobileSplashDesc" hidden>
    <div class="mobile-splash-card" role="document">
      <div class="mobile-splash-brand">
        <span class="logo-mark" aria-hidden="true">
          <svg class="logo-glyph" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="7" y1="12" x2="16.5" y2="7"/>
            <line x1="7" y1="12" x2="16.5" y2="17"/>
            <line x1="16.5" y1="7" x2="16.5" y2="17"/>
            <circle cx="7" cy="12" r="2" fill="currentColor" stroke="none"/>
            <circle cx="16.5" cy="7" r="2" fill="currentColor" stroke="none"/>
            <circle cx="16.5" cy="17" r="2" fill="currentColor" stroke="none"/>
          </svg>
        </span>
        <span class="logo-text"><span class="logo-strong">Collab</span>Connect</span>
      </div>
      <h2 id="mobileSplashTitle">Mobile version in development</h2>
      <p id="mobileSplashDesc" class="mobile-splash-desc">The Social experience isn’t ready for mobile yet. Please use the desktop site for now. We’re polishing the mobile version.</p>
      <div class="mobile-splash-actions">
        <button id="mobileSplashHome" class="btn primary">Go to Home</button>
      </div>
      <p class="mobile-splash-foot">Thanks for your patience.</p>
    </div>
  </div>
  <script>
    // View switch wiring
    (function setupViewSwitch(){
      const tabs = document.querySelectorAll('.social-switch .tab');
      const feedList = document.getElementById('feed');
      const scrollWrap = document.querySelector('.center-scroll');
      if (!tabs.length || !feedList) return;
      function setMode(mode){
        feedList.setAttribute('data-mode', mode);
        if (scrollWrap) scrollWrap.classList.toggle('videos-mode', mode === 'videos');
        try { localStorage.setItem('cc:social:view', mode); } catch(_){}
      }
      tabs.forEach(btn => btn.addEventListener('click', () => {
        const view = btn.dataset.view;
        tabs.forEach(t => { const active = t===btn; t.classList.toggle('is-active', active); t.setAttribute('aria-selected', String(active)); });
        setMode(view === 'projects' ? 'projects' : view === 'videos' ? 'videos' : 'all');
      }));
      (function init(){
        const url = new URL(window.location.href);
        let view = url.searchParams.get('view') || 'all';
        try { view = localStorage.getItem('cc:social:view') || view; } catch(_){}
        if (view === 'posts') view = 'projects';
        const target = document.querySelector(`.social-switch .tab[data-view="${view}"]`) || document.querySelector('.social-switch .tab[data-view="all"]');
        target && target.click();
      })();
    })();
  </script>
  <script>
    // Block Social on small screens for normal users; dev accounts bypass automatically.
    (function mobileSplashGuard(){
      const overlay = document.getElementById('mobileBlocker');
      if (!overlay) return;
      function apply(state){
        const main = document.getElementById('main');
        const nav = document.querySelector('.navbar');
        const footer = document.querySelector('.site-footer');
        if (state) {
          overlay.hidden = false;
          document.documentElement.style.overflow = 'hidden';
          [main, nav, footer].forEach(el => el && el.setAttribute('aria-hidden', 'true'));
        } else {
          overlay.hidden = true;
          document.documentElement.style.overflow = '';
          [main, nav, footer].forEach(el => el && el.removeAttribute('aria-hidden'));
        }
      }
      function evaluate(){
        let email = '';
        try { email = localStorage.getItem('cc:userEmail') || ''; } catch(_) {}
        const isDev = /^(dev@collabconnect\.dev|devuser@example\.com)$/i.test(email);
        if (isDev) { apply(false); return; }
        const isSmall = window.matchMedia('(max-width: 820px)').matches;
        apply(isSmall);
      }
      const homeBtn = document.getElementById('mobileSplashHome');
      if (homeBtn) homeBtn.addEventListener('click', () => { window.location.href = 'index.html'; });
      const mq = window.matchMedia('(max-width: 820px)');
      mq.addEventListener ? mq.addEventListener('change', evaluate) : mq.addListener(evaluate);
      window.addEventListener('orientationchange', evaluate);
  // Run once now and again on DOM ready in case auth initializes later
  evaluate();
  document.addEventListener('DOMContentLoaded', evaluate);
    })();
  </script>
  <script>
    // Mobile composer wiring (FAB + modal), independent from desktop composer
    (function mobileComposer(){
      const fab = document.getElementById('composerFab');
      const modal = document.getElementById('composerMobileModal');
      const closeBtn = modal?.querySelector('.close');
      const form = document.getElementById('composerFormMobile');
      const textarea = document.getElementById('composerTextMobile');
      const postBtn = form ? form.querySelector('button[type="submit"]') : null;
      const counter = document.getElementById('composerCountMobile');
      const avatar = document.getElementById('composerAvatarMobile');

      function showFab(state){ if (fab) fab.hidden = !state; }
      function open(){ if (!modal) return; modal.setAttribute('aria-hidden','false'); modal.style.display='flex'; textarea?.focus(); }
      function close(){ if (!modal) return; modal.setAttribute('aria-hidden','true'); modal.style.display=''; }
      function onResize(){ const isSmall = window.matchMedia('(max-width: 820px)').matches; showFab(isSmall); if (!isSmall) close(); }

      // Init avatar from auth
      (function initAvatar(){ try { const email = (window.CCAuth && CCAuth.getUser && CCAuth.getUser()) || 'user@example.com'; const init = (email.split('@')[0]||'U')[0].toUpperCase(); avatar && (avatar.textContent = init); } catch(_){} })();

      function updateState(){ const val = (textarea?.value || ''); const clean = val.replace(/\s+/g,' ').trim(); const max = parseInt(textarea?.getAttribute('maxlength')||'280',10); if (counter) counter.textContent = `${Math.min(val.length, max)}/${max}`; if (postBtn) postBtn.disabled = clean.length === 0; }

      fab && fab.addEventListener('click', open);
      closeBtn && closeBtn.addEventListener('click', close);
      modal && modal.addEventListener('click', (e)=>{ if (e.target === modal) close(); });
      textarea && textarea.addEventListener('input', updateState);
      textarea && textarea.addEventListener('keydown', e => { if ((e.metaKey||e.ctrlKey) && e.key==='Enter'){ e.preventDefault(); postBtn && !postBtn.disabled && postBtn.click(); }});
      form && form.addEventListener('submit', e => {
        e.preventDefault();
        const text = (textarea.value||'').replace(/\s+/g,' ').trim();
        if (!text) return;
        try {
          // Reuse social.js composer format via event
          const ev = new CustomEvent('cc:composer:new', { detail: { text } });
          window.dispatchEvent(ev);
        } catch(_){ /* no-op */ }
        textarea.value = ''; updateState(); close();
      });

      window.addEventListener('resize', onResize);
      onResize(); updateState();
    })();
  </script>
</body>
</html>
